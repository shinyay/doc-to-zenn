---
title: "100日後にRustをちょっと知ってる人になる: [Day 43]モジュールシステム"
emoji: "🦀"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [rust]
published: false
---
## Day 43 のテーマ

[Day 42](https://zenn.dev/shinyay/articles/hello-rust-day042) で Rust プログラムにメタデータを追加して性質や機能を追加する仕組みの**属性 (アトリビュート)** について見てみました。

この属性は Rust のモジュールシステムを通して様々な対象に付与することができました。
この Rust のモジュールシステムは、他の言語と比べても強力なものだと言われています。
というわけで、改めて Rust のモジュールシステムについて考えてみたいと思います。

## モジュールシステム

以前にも Rust のモジュールの仕組みについてまとめたことがありましたが、あらためて表でまとめます。

|モジュールシステムの要素|説明|
|--------------------|---|
|パッケージ|Cargo で管理する Rust プロジェクト|
|クレート|パッケージに含まれれる**実行バイナリ**および**ライブラリ**|
|モジュール|関数などの要素を含む論理的な階層|

### クレート

クレートは多分 Rust 特有の言葉なのかなと思います。僕の知っている限りでは他の言語で聞いた事がないので。
Crate という単語は木枠という意味の単語で、Rust では**ソースコードを格納するところ**のことをクレートと呼んでいます。
`cargo new` コマンドでパッケージを作成すると、デフォルトでクレートが 1 つ作成されています。

クレートには次の 2 種類があります。

- 実行バイナリクレート (`cargo new --bin (bin は省略可)`)
- ライブラリクレート (`cargo new --lib`)

#### 実行バイナリクレート

実行バイナリクレートは、**エントリポイント (main 関数)** を持つクレートです。
`cargo` コマンドで作成したパッケージ内につくられる `main.rs` が**クレート**になり、**モジュールの基点** になるので**クレートルート**とも呼びます。

```shell
modules/
├── Cargo.toml
└── src
    └── main.rs <--- クレートルート
```

#### ライブラリクレート

ライブラリクレートは、**エントリポイントを持たない**クレートです。

```shell
libraries/
├── Cargo.toml
└── src
    └── lib.rs <--- クレートルート
```

実行バイナリが存在しているところで、ライブラリクレートを作成し 2 つのクレートルートを持つパッケージを作成することも可能です。

### モジュール

モジュールとは、クレートの中の構成要素に対して名前空間を付与して論理的な階層構造をもたせることができるような仕組みです。

`mod` キーワードによってモジュールを定義します。また、モジュール本体は、`{}` (波括弧) で囲んだ部分になります。また、モジュール内部にモジュールを定義することも可能です。

```rust
mod Module1 {
    mod Module2 {
        fn doSomething()
    }

    mod Module3 {
        fn doSomethingElse()
        fn doNothing()
    }
}
```

## Day 43 のまとめ
