---
title: "100æ—¥å¾Œã«Rustã‚’ã¡ã‚‡ã£ã¨çŸ¥ã£ã¦ã‚‹äººã«ãªã‚‹: [Day 92]æ›¸ç±: Webã‚¢ãƒ—ãƒªé–‹ç™ºã§å­¦ã¶Rustè¨€èªå…¥é–€ ãã®2"
emoji: "ğŸ¦€"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [rust]
published: false
---
## Day 92 ã®ãƒ†ãƒ¼ãƒ

[Day 91](https://zenn.dev/shinyay/articles/hello-rust-day091) ã‹ã‚‰èª­ã¿å§‹ã‚ãŸ [Webã‚¢ãƒ—ãƒªé–‹ç™ºã§å­¦ã¶ Rustè¨€èªå…¥é–€](shuwasystem.co.jp/book/9784798067315.html) ã®ã§ã™ãŒã€ä»Šæ—¥ã‚‚èª­ã¿é€²ã‚ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/0abe692735b6-20221220.png)

- **ç¬¬ 1 ç«  Rustã¨Webé–‹ç™º**
  - 1.1 Rustã§ã®é–‹ç™ºã®æº–å‚™
- **ç¬¬ 2 ç«  RuståŸºç¤**
  - 2.1 å¤‰æ•°ã¨ãƒ‡ãƒ¼ã‚¿å‹
  - 2.2 é–¢æ•°ã®å®Ÿè£…
  - 2.3 åˆ¶å¾¡æ§‹é€ 
  - 2.4 æ‰€æœ‰æ¨©ã«ã‚ˆã‚‹å®‰å…¨æ€§
  - 2.5 ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
  - 2.6 async/await
  - 2.7 ã‚¯ãƒ¬ãƒ¼ãƒˆã¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
  - 2.8 ãƒ†ã‚¹ãƒˆ
  - 2.9 ã‚ˆãä½¿ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **ç¬¬ 3 ç«  axumã‚’ä½¿ã£ã¦httpãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã™ã‚‹**
  - [3.1 axumã¨ã¯](https://zenn.dev/shinyay/articles/hello-rust-day091#%E7%AC%AC-3-%E7%AB%A0-axum%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6http%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%82%92%E5%87%A6%E7%90%86%E3%81%99%E3%82%8B---3.1-axum%E3%81%A8%E3%81%AF)
  - [3.2 ç’°å¢ƒæ§‹ç¯‰](https://zenn.dev/shinyay/articles/hello-rust-day091#%E7%AC%AC-3-%E7%AB%A0-axum%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6http%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%82%92%E5%87%A6%E7%90%86%E3%81%99%E3%82%8B---3.2-%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89)
  - 3.3 ãƒ†ã‚¹ãƒˆ
  - 3.4 Todoæƒ…å ±ã‚’ä¿å­˜ã™ã‚‹
  - 3.5 httpãƒªã‚¯ã‚¨ã‚¹ãƒˆ
  - 3.6 ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®è¿½åŠ 
- **ç¬¬ 4 ç«  sqlxã‚’ä½¿ã£ã¦CRUDã‚’å®Ÿè£…ã™ã‚‹**
  - 4.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŸºç¤
  - 4.2 sqlxã¨ã¯
  - 4.3 axumã¨sqlx
  - 4.4 todoã®CRUD
  - 4.5 sqlxã®ãƒ†ã‚¹ãƒˆ
- **ç¬¬ 5 ç«  Todoã‚¢ãƒ—ãƒªã®ä½“è£ã‚’æ•´ãˆã‚‹**
  - 5.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º
  - 5.2 Reactç’°å¢ƒæ§‹ç¯‰
  - 5.3 Todoã‚¢ãƒ—ãƒªã®UIå®Ÿè£…
  - 5.4 å¤–éƒ¨APIã¨ã®é€šä¿¡ï¼ˆ1ï¼‰
  - 5.5 å¤–éƒ¨APIã¨ã®é€šä¿¡ï¼ˆ2ï¼‰
- **ç¬¬ 6 ç«  Todoã«ãƒ©ãƒ™ãƒ«ã‚’ã¤ã‘ã‚‹**
  - 6.1 ãƒ©ãƒ™ãƒ«ã®CRUD
  - 6.2 TodoRepositoryã®ãƒ©ãƒ™ãƒ«å¯¾å¿œ
  - 6.3 ãƒ©ãƒ™ãƒ«æ©Ÿèƒ½ã‚’ç”»é¢ã«è¿½åŠ ã™ã‚‹
  - 6.4 ã•ã‚‰ãªã‚‹æ©Ÿèƒ½æ‹¡å¼µ

## ç¬¬ 3 ç«  axumã‚’ä½¿ã£ã¦httpãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã™ã‚‹ - 3.2 ç’°å¢ƒæ§‹ç¯‰

### ãƒ­ã‚®ãƒ³ã‚°

å‰å›ä½œæˆã—ãŸã‚³ãƒ¼ãƒ‰ã«ã¯ã¾ã ãƒ­ã‚°å‡ºåŠ›ã«é–¢ã™ã‚‹å®Ÿè£…ã¯ã—ã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ãã“ã§ã€ãƒ­ã‚°å‡ºåŠ›ã‚’è¿½åŠ ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ãƒ­ã‚°å‡ºåŠ›ã«ã¯æ¬¡ã®ã‚¯ãƒ¬ãƒ¼ãƒˆã‚’ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

- [tracing](https://crates.io/crates/tracing)

`tracing_subscriber::fmt::init();` ã«ã‚ˆã£ã¦ `tracing` ã®åˆæœŸåŒ–ã‚’è¡Œã„ã¾ã™ã€‚

ãã—ã¦ `debug` ãƒ¬ãƒ™ãƒ«ã®å ´åˆã«å‡ºåŠ›ã™ã‚‹ãƒ­ã‚°ã¯æ¬¡ã®æ§˜ã« `debug` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦å‡ºåŠ›ã‚’è¡Œã„ã¾ã™ã€‚

```rust
let addr = SocketAddr::from(([127, 0, 0, 1], 3000));
tracing::debug!("listening on {}", addr);
```

```shell
$ RUST_LOG=debug cargo run

2022-12-21T03:46:00.781809Z DEBUG day_91_hello_axum: listening on 127.0.0.1:3000
2022-12-21T03:46:07.831426Z DEBUG hyper::proto::h1::io: parsed 3 headers
2022-12-21T03:46:07.831466Z DEBUG hyper::proto::h1::conn: incoming body is empty
2022-12-21T03:46:07.831704Z DEBUG hyper::proto::h1::io: flushed 129 bytes
2022-12-21T03:46:07.831932Z DEBUG hyper::proto::h1::conn: read eof
```

### å…¥å‡ºåŠ›ç”¨ JSON ãƒ‡ãƒ¼ã‚¿

æ¬¡ã« GET ãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ã§ãªãã€POST ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ‰±ã†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã—ã¾ã™ã€‚
ã¾ãšã€ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã¨ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã«æœŸå¾…ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®å‹ã¨ã—ã¦ã€æ§‹é€ ä½“ã‚’ç”¨æ„ã—ã¾ã™ã€‚

å…¥åŠ›ç”¨

```rust
#[derive(Deserialize)]
struct CreateUser {
    username: String,
}
```

å‡ºåŠ›ç”¨

```rust
#[derive(Serialize)]
struct User {
    id: u64,
    username: String,
}
```

ãã‚Œãã‚Œã€å…¥åŠ›æ™‚ã«ã¯ `Deserialize`, å‡ºåŠ›æ™‚ã«ã¯ `Serialize` ã‚’è¡Œã£ã¦ JSON ã‚’æ‰±ã£ã¦ã„ã¾ã™ã€‚

```rust
async fn create_user (Json(payload): Json<CreateUser>) -> impl IntoResponse {
    :
    :
    (StatusCode::CREATED, Json(user))
}
```

axum::Json ã«ã‚ˆã‚Šãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‚’ serde::Serialize ã‚’å®Ÿè£…ã—ãŸä½•ã‚‰ã‹ã®å‹ã«ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

- [axum::Json](https://docs.rs/axum/0.2.3/axum/struct.Json.html)

## Day 92 ã®ã¾ã¨ã‚

ãƒ­ã‚°å‡ºåŠ›ã«é–¢ã—ã¦ã¨ã€GETã«åŠ ãˆã¦POSTãƒ¡ã‚½ãƒƒãƒ‰ã®æ‰±ã„ã«ã¤ã„ã¦ç¢ºèªã‚’ã—ã¦ã¿ã¾ã—ãŸã€‚
